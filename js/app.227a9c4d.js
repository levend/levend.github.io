(function(e){function t(t){for(var a,o,l=t[0],s=t[1],c=t[2],p=0,d=[];p<l.length;p++)o=l[p],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&d.push(r[o][0]),r[o]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a]);u&&u(t);while(d.length)d.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,l=1;l<n.length;l++){var s=n[l];0!==r[s]&&(a=!1)}a&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var a={},r={app:0},i=[];function o(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=a,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],s=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var u=s;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";n("85ec")},"2ee6":function(e,t,n){"use strict";n("80ff")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("7db0"),n("d3b7"),n("b0c0"),n("ac1f"),n("1276"),n("25f0");var a,r,i=n("2b0e"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("h1",[e._v("WSPR SNR Plotter")]),n("router-view")],1)},l=[],s={name:"App",data:function(){return{}},methods:{}},c=s,u=(n("034f"),n("2877")),p=Object(u["a"])(c,o,l,!1,null,null,null),d=p.exports,h=n("8c4f"),m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"SNRPage"}},[e._m(0),e._v(" First Callsign: "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.callsign1,expression:"callsign1"},{name:"uppercase",rawName:"v-uppercase"}],attrs:{type:"text"},domProps:{value:e.callsign1},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getWSPRData.apply(null,arguments)},input:function(t){t.target.composing||(e.callsign1=t.target.value)}}}),e._v(" Second Callsign: "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.callsign2,expression:"callsign2"},{name:"uppercase",rawName:"v-uppercase"}],attrs:{type:"text"},domProps:{value:e.callsign2},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getWSPRData.apply(null,arguments)},input:function(t){t.target.composing||(e.callsign2=t.target.value)}}}),n("div",{staticClass:"demo",attrs:{id:"v-model-select-dynamic"}},[e._v(" Band: "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.selected_band,expression:"selected_band"}],on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selected_band=t.target.multiple?n:n[0]}}},e._l(e.band_options,(function(t){return n("option",{key:t.name,domProps:{value:t.value}},[e._v(" "+e._s(t.text)+" ")])})),0)]),n("label",{attrs:{for:"normalize_snr"}},[e._v("Normalize SNR to 5W TX power")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.normalize_snr,expression:"normalize_snr"}],attrs:{type:"checkbox",id:"normalize_snr"},domProps:{checked:Array.isArray(e.normalize_snr)?e._i(e.normalize_snr,null)>-1:e.normalize_snr},on:{change:[function(t){var n=e.normalize_snr,a=t.target,r=!!a.checked;if(Array.isArray(n)){var i=null,o=e._i(n,i);a.checked?o<0&&(e.normalize_snr=n.concat([i])):o>-1&&(e.normalize_snr=n.slice(0,o).concat(n.slice(o+1)))}else e.normalize_snr=r},e.normalizeCheckboxChanged]}}),n("br"),n("button",{on:{click:e.getWSPRData}},[e._v("Get data")]),e.loaded?n("line-chart",{attrs:{plot1ChartData:e.plot1ChartData,plot1Title:e.plot1Title,plot2ChartData:e.plot2ChartData,plot2Title:e.plot2Title}}):e._e()],1)},f=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("h4",[e._v(" Specify two callsigns and see how they heard each other in the last 24 hours."),n("br"),e._v(" All data coming from wspr.live DB ")])}],v=n("1da1"),g=(n("96cf"),n("e9c4"),n("159b"),n("d81d"),n("5319"),n("498a"),n("99af"),n("1fca")),b={extends:g["a"],props:{plot1ChartData:{type:Array,required:!1},plot1Title:{type:String,required:!1},plot2ChartData:{type:Array,required:!1},plot2Title:{type:String,required:!1}},watch:{plot1ChartData:function(){this.renderLineChart()},plot2ChartData:function(){this.renderLineChart()}},data:function(){return{options:{scales:{yAxes:[{ticks:{beginAtZero:!0},gridLines:{display:!0}}],xAxes:[{gridLines:{display:!1},type:"time",distribution:"linear",time:{displayFormats:{minute:"HH:mm"}}}]},legend:{display:!0},responsive:!0,maintainAspectRatio:!1}}},mounted:function(){this.renderLineChart()},methods:{renderLineChart:function(){this.renderChart({datasets:[{label:this.plot1Title,borderColor:"#249E00",pointBackgroundColor:"#249E00",pointBorderColor:"#249EBF",borderWidth:1,backgroundColor:"transparent",data:this.plot1ChartData},{label:this.plot2Title,borderColor:"#209EBF",pointBackgroundColor:"#209EBF",pointBorderColor:"#209EBF",borderWidth:1,backgroundColor:"transparent",data:this.plot2ChartData}]},this.options)}}},y=b,x=Object(u["a"])(y,a,r,!1,null,null,null),_=x.exports,w={name:"SNRPage",components:{LineChart:_},mounted:function(){console.log("Params:"+JSON.stringify(this.$route.params)),this.$route.params.call1&&this.$route.params.call2&&this.$route.params.band&&(this.callsign1=this.$route.params.call1,this.callsign2=this.$route.params.call2,this.selected_band=this.$route.params.band,this.getWSPRData())},data:function(){return{loaded:!1,normalize_snr:!1,callsign1:"",callsign2:"",selected_band:3,band_options:[{text:"2200m",value:-1},{text:"630m",value:0},{text:"160m",value:1},{text:"80m",value:3},{text:"60m",value:5},{text:"40m",value:7},{text:"30m",value:10},{text:"20m",value:14},{text:"17m",value:18},{text:"15m",value:21},{text:"12m",value:24},{text:"10m",value:28},{text:"6m",value:50},{text:"4m",value:70},{text:"2m",value:144},{text:"70cm",value:432},{text:"23cm",value:1296}],plot1ChartData:[],plot1Title:"",plot2ChartData:[],plot2Title:"",wsprData1:[],wsprData2:[]}},methods:{normalizeCheckboxChanged:function(){this.loaded&&this.plotData()},getCallData:function(e,t){var n=this;return Object(v["a"])(regeneratorRuntime.mark((function a(){var r,i,o,l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r="select\t* from wspr.rx where time > subtractHours(now(), 24) and tx_sign = '"+e+"' and rx_sign = '"+t+"' and band = "+n.selected_band+" order by time format JSON",console.log("Query string:"+r),a.next=4,fetch("https://db1.wspr.live/?query="+r);case 4:return i=a.sent,a.next=7,i.json();case 7:return o=a.sent,l=[],o.data.forEach((function(e){var t=l.find((function(t){return t.time===e.time}));t?t.snr<e.snr&&(t.snr=e.snr):l.push(e)})),a.abrupt("return",l);case 11:case"end":return a.stop()}}),a)})))()},fetchData:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getCallData(e.callsign1,e.callsign2);case 2:return e.wsprData1=t.sent,t.next=5,e.getCallData(e.callsign2,e.callsign1);case 5:e.wsprData2=t.sent;case 6:case"end":return t.stop()}}),t)})))()},plotData:function(){var e=this;this.loaded=!1,this.plot1ChartData=[],this.plot1ChartData=this.wsprData1.map((function(t){e.normalizedSNR(t);var n={};return n.x=new Date(t.time.replace(/-/g,"/")),n.y=e.normalizedSNR(t),n})),this.plot2ChartData=[],this.plot2ChartData=this.wsprData2.map((function(t){var n={};return n.x=new Date(t.time.replace(/-/g,"/")),n.y=e.normalizedSNR(t),n})),this.plot1Title=this.callsign2+" hearing "+this.callsign1,this.plot2Title=this.callsign1+" hearing "+this.callsign2,this.loaded=!0},normalizedSNR:function(e){var t=37,n=e.snr;if(this.normalize_snr&&e.power!=t){var a=e.power-t;console.log("Power difference: "+a),n=a<=0?e.snr+Math.abs(a):e.snr-Math.abs(a)}return n},getWSPRData:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loaded=!1,e.callsign1=e.callsign1.trim(),e.callsign2=e.callsign2.trim(),e.setURL(),t.next=6,e.fetchData();case 6:e.plotData();case 7:case"end":return t.stop()}}),t)})))()},setURL:function(){history.pushState({call1:this.callsign1,call2:this.callsign2,band:this.selected_band},"WSPR SNR","/#/calls/".concat(this.callsign1,"/").concat(this.callsign2,"/band/").concat(this.selected_band))}}},C=w,D=(n("2ee6"),Object(u["a"])(C,m,f,!1,null,null,null)),k=D.exports;i["a"].use(h["a"]);var S=new h["a"]({routes:[{path:"/calls/:call1/:call2/band/:band",component:k},{path:"/",component:k}]});i["a"].config.productionTip=!1,i["a"].directive("uppercase",{twoWay:!0,unbind:function(){},bind:function(e,t,n){var a=function(e){try{return e.data.directives.find((function(e){return"model"===e.name})).expression}catch(t){throw t.message="Unable to find v-model directive at ".concat(e.tag," tag. Please specify the expression: v-uppercase='obj.prop'"),t}},r=function(e,t,n){for(var a=e.split("."),r=a.pop(),i=0;i<a.length;i++)t=t[a[i]];return t[r]=n},i=t.expression?t.expression:a(n);n.context.$watch(i,{immediate:!0,handler:function(e){if(e)return r(i,n.context,e.toString().toLocaleUpperCase())}})}}),new i["a"]({router:S,render:function(e){return e(d)}}).$mount("#app")},"80ff":function(e,t,n){},"85ec":function(e,t,n){},be5e:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="be5e"}});
//# sourceMappingURL=app.227a9c4d.js.map